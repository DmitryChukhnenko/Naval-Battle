# Морской бой 2  

Проект представляет собой многопользовательскую игру "Морской бой" с расширенным функционалом, основанную на предыдущей реализации ASP .NET Core. Отличительной особенностью второй части станет поддержка множества режимов игры и возможность одновременного участия более двух игроков, что откроет новые стратегические горизонты. Все игры сохраняются в общей базе данных, включающей расстановку кораблей и историю ходов.

## Naval Battle  
Классическая многопользовательская игра "Морской бой" (Battleship), разработанная на C# с использованием WPF. Приложение позволяет пользователям создавать собственные игровые серверы или подключаться к существующим через TCP/IP для интерактивного и стратегического игрового процесса.

## Возможности  
* **Многопользовательский режим:** Создавайте игру и приглашайте других игроков через локальную сеть, или присоединяйтесь к чужой игре.  
* **TCP/IP сетевая коммуникация:** Все игровые события обрабатываются через кастомный TCP протокол, обеспечивающий синхронизацию состояния игры, ходов игроков и обновлений в реальном времени.  
* **Динамические игровые лобби:** Игроки видят текущих участников до начала игры. Хост управляет стартом матча.  
* **Настройка игры:** Хост может задать:  
  * **Размер поля:** От 3x3 до 20x20 клеток.  
  * **Размер флота:** Количество кораблей автоматически балансируется относительно размера поля.  
* **Стратегическое расставление кораблей:** Перед началом боя каждый игрок расставляет свои корабли на своем поле.  
* **Походовая система:** Игроки делают ходы поочередно, выбирая ячейки на поле противника.  
* **Реакция в реальном времени:** Мгновенная визуализация попаданий, промахов и уничтоженных кораблей.  
* **История игр:** Все завершенные партии, включая расстановку кораблей и полную историю ходов, сохраняются в локальной базе данных для последующего просмотра.

## Как играть  

### Создание игры  
1. Запустите приложение.  
2. Введите свой никнейм.  
3. Нажмите кнопку **Хост**.  
4. На экране создания игры задайте **Размер флота** и **Размер поля**.  
5. Нажмите **Хост** снова. Вы попадете в игровое лобби.  
6. Ваш локальный IP отображается как **ID игры**. Передайте его другим игрокам для подключения.  
7. Дождитесь подключения всех игроков. Их имена появятся в списке **Игроки**.  
8. Когда все готовы, нажмите **Играть**, чтобы начать матч.  

### Присоединение к игре  
1. Запустите приложение.  
2. Введите свой никнейм.  
3. В поле **Введите ID игры** введите IP-адрес (ID), предоставленный хостом.  
4. Нажмите кнопку **Играть** справа от поля ввода ID.  
5. Вы подключитесь к лобби. Дождитесь, пока хост запустит игру.  

### Игровой процесс  
1. **Фаза расстановки:** После старта игры вы попадете на экран расстановки. Нажимайте на ячейки своего поля, чтобы разместить корабли. Используйте все доступные корабли. Нажмите **Отправить**, когда закончите.  
2. **Фаза боя:** После подтверждения всех игроков начинается походовая система. Когда наступает ваш ход, нажмите на ячейку на поле противника, чтобы выстрелить.  
3. **Победа:** Игра заканчивается, когда остается один игрок с неповрежденными кораблями. Победитель объявляется всем участникам.  

## История игр  
Приложение автоматически сохраняет каждую завершенную партию. Для просмотра:  

1. В главном меню нажмите **Открыть сохранения**.  
2. Откроется окно со списком всех сохраненных игр.  
3. Данные включают JSON-представление полей игроков и полную историю ходов.  

## Технические детали  

### Технологический стек  
* **Фреймворк:** .NET 8  
* **Интерфейс:** Windows Presentation Foundation (WPF)  
* **База данных:** Entity Framework Core 8 с SQL Server LocalDB  
* **Сетевые технологии:** Кастомная реализация TCP-клиента/сервера через `System.Net.Sockets`.  
* **Архитектура:** UI построен по паттерну Model-View-ViewModel (MVVM) с использованием `Prism.Mvvm.BindableBase` для уведомлений об изменениях свойств.  

### Структура проекта  
* **`Client`**: Основной WPF-проект с визуальными элементами (XAML), view-моделями, игровой логикой, сетевым кодом (как клиентским, так и серверным) и моделями данных (`Player`, `OneCell` и др.).  
* **`GameData`**: Библиотека классов для работы с данными. Содержит `GameDataContext` (на основе EF Core) и модель `Save` для хранения завершенных партий в БД.  

## Установка и запуск  
1. Склонируйте репозиторий на локальную машину.  
2. Откройте файл решения `Naval Battle.sln` в Visual Studio 2022 или новее.  
3. Убедитесь, что установлен .NET 8 SDK.  
4. Проект использует Entity Framework Core с экземпляром SQL Server LocalDB. База данных создастся автоматически при первом запуске приложения, если LocalDB установлен. Строка подключения указана в `GameData/GameDataContext.cs`.  
5. Установите проект `Client` как стартовый.  
6. Соберите и запустите решение.  

## Лицензия  
Проект распространяется под лицензией Apache License 2.0. Подробности в файле [LICENSE](LICENSE).
